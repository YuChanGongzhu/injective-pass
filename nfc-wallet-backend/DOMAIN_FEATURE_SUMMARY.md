# NFCé’±åŒ… - .injåŸŸååŠŸèƒ½è¯¦è§£

## ðŸŽ¯ åŠŸèƒ½æ¦‚è¿°

æ ¹æ®å®žé™…éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸ºNFCé’±åŒ…ç”¨æˆ·æä¾›**è‡ªå®šä¹‰.injåŸŸå**åŠŸèƒ½ï¼Œè€Œä¸æ˜¯ç®€å•çš„ç”¨æˆ·åã€‚ç”¨æˆ·å¯ä»¥è®¾ç½®ä¸ªæ€§åŒ–çš„åŸŸåå‰ç¼€ï¼Œç³»ç»Ÿè‡ªåŠ¨æ·»åŠ `.inj`åŽç¼€ï¼Œå½¢æˆå®Œæ•´çš„åŸŸåæ ‡è¯†ã€‚

## ðŸ·ï¸ åŸŸåç³»ç»Ÿç‰¹æ€§

### æ ¸å¿ƒç‰¹ç‚¹
- **ä¸ªæ€§åŒ–å‰ç¼€**: ç”¨æˆ·å¯è‡ªå®šä¹‰3-30å­—ç¬¦çš„åŸŸåå‰ç¼€
- **è‡ªåŠ¨åŽç¼€**: ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ `.inj`åŽç¼€
- **å…¨å±€å”¯ä¸€**: ç¡®ä¿åŸŸååœ¨æ•´ä¸ªç³»ç»Ÿä¸­å”¯ä¸€
- **DNSè§„èŒƒ**: ç¬¦åˆæ ‡å‡†åŸŸåæ ¼å¼è¦æ±‚

### åŸŸåæ ¼å¼è§„åˆ™
```
ç”¨æˆ·è¾“å…¥: "alice"
ç³»ç»Ÿç”Ÿæˆ: "alice.inj"

æ ¼å¼è¦æ±‚:
- é•¿åº¦: 3-30å­—ç¬¦ï¼ˆä¸å«.injåŽç¼€ï¼‰
- å­—ç¬¦: å°å†™å­—æ¯ã€æ•°å­—ã€è¿žå­—ç¬¦
- é™åˆ¶: ä¸èƒ½ä»¥è¿žå­—ç¬¦å¼€å¤´æˆ–ç»“å°¾
- ç¦æ­¢: è¿žç»­è¿žå­—ç¬¦(--)
```

## ðŸ”§ æŠ€æœ¯å®žçŽ°

### æ•°æ®åº“æž¶æž„
```sql
-- æ›´æ–°åŽçš„é’±åŒ…è¡¨ç»“æž„
CREATE TABLE nfc_wallets (
  id SERIAL PRIMARY KEY,
  uid VARCHAR(255) UNIQUE NOT NULL,    -- NFCå¡ç‰‡UID
  address VARCHAR(63) NOT NULL,        -- Injectiveåœ°å€
  eth_address VARCHAR(42),             -- ä»¥å¤ªåŠåœ°å€ï¼ˆå…¼å®¹ï¼‰
  domain VARCHAR(70) UNIQUE,           -- .injåŸŸåï¼ˆå¯é€‰ä¸”å”¯ä¸€ï¼‰
  private_key_enc TEXT NOT NULL,       -- åŠ å¯†ç§é’¥
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### APIç«¯ç‚¹è®¾è®¡
```typescript
// 1. è®¾ç½®åŸŸå
PUT /api/user/domain
Body: { uid: string, domainPrefix: string }

// 2. æ£€æŸ¥åŸŸåå¯ç”¨æ€§
GET /api/user/check-domain/:domainPrefix

// 3. æ ¹æ®åŸŸåæŸ¥æ‰¾ç”¨æˆ·
GET /api/user/search/:domain

// 4. åˆ é™¤åŸŸå
DELETE /api/user/domain/:uid
```

### éªŒè¯é€»è¾‘
```typescript
private validateDomainPrefix(domainPrefix: string): boolean {
  const regex = /^[a-z0-9]+([a-z0-9-]*[a-z0-9])?$/;
  return domainPrefix.length >= 3 && 
         domainPrefix.length <= 30 && 
         regex.test(domainPrefix) &&
         !domainPrefix.includes('--');
}
```

## ðŸ“¡ APIä½¿ç”¨ç¤ºä¾‹

### è®¾ç½®ç”¨æˆ·åŸŸå
```bash
curl -X PUT http://localhost:3000/api/user/domain \
  -H "Content-Type: application/json" \
  -d '{
    "uid": "04:1a:2b:3c:4d:5e:6f",
    "domainPrefix": "alice"
  }'
```

**å“åº”**:
```json
{
  "address": "inj1abc123...",
  "ethAddress": "0x742d35Cc6bb...",
  "uid": "04:1a:2b:3c:4d:5e:6f",
  "domain": "alice.inj",
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T00:00:00.000Z"
}
```

### æ£€æŸ¥åŸŸåå¯ç”¨æ€§
```bash
curl http://localhost:3000/api/user/check-domain/alice
```

**å“åº”**:
```json
{
  "available": false  // åŸŸåå·²è¢«å ç”¨
}
```

### æ ¹æ®åŸŸåæŸ¥æ‰¾ç”¨æˆ·
```bash
curl http://localhost:3000/api/user/search/alice.inj
```

**å“åº”**:
```json
{
  "address": "inj1abc123...",
  "uid": "04:1a:2b:3c:4d:5e:6f",
  "domain": "alice.inj",
  "createdAt": "2024-01-01T00:00:00.000Z"
}
```

## ðŸ” åŸŸåéªŒè¯è§„åˆ™

### âœ… æœ‰æ•ˆåŸŸåå‰ç¼€ç¤ºä¾‹
- `alice` â†’ `alice.inj`
- `bob123` â†’ `bob123.inj`
- `user-name` â†’ `user-name.inj`
- `abc` â†’ `abc.inj` (æœ€çŸ­3å­—ç¬¦)

### âŒ æ— æ•ˆåŸŸåå‰ç¼€ç¤ºä¾‹
- `ab` âŒ å¤ªçŸ­ï¼ˆå°äºŽ3å­—ç¬¦ï¼‰
- `-alice` âŒ ä»¥è¿žå­—ç¬¦å¼€å¤´
- `alice-` âŒ ä»¥è¿žå­—ç¬¦ç»“å°¾
- `Alice` âŒ åŒ…å«å¤§å†™å­—æ¯
- `alice@bob` âŒ åŒ…å«ç‰¹æ®Šå­—ç¬¦
- `alice--bob` âŒ è¿žç»­è¿žå­—ç¬¦

## ðŸŽ¯ ä½¿ç”¨åœºæ™¯

### 1. ç”¨æˆ·èº«ä»½æ ‡è¯†
- æ›¿ä»£å¤æ‚çš„é’±åŒ…åœ°å€
- ä¾¿äºŽè®°å¿†å’Œåˆ†äº«
- æå‡ç”¨æˆ·ä½“éªŒ

### 2. ç¤¾äº¤åŠŸèƒ½
- æœ‹å‹å¯é€šè¿‡åŸŸåæŸ¥æ‰¾ç”¨æˆ·
- ç®€åŒ–è½¬è´¦æ“ä½œ
- æž„å»ºç”¨æˆ·ç½‘ç»œ

### 3. å“ç‰Œæ ‡è¯†
- ä¼ä¸šç”¨æˆ·å¯ç”³è¯·å“ç‰ŒåŸŸå
- å¢žå¼ºå“ç‰Œè®¤çŸ¥åº¦
- ä¸“ä¸šå½¢è±¡å±•ç¤º

## ðŸ” å®‰å…¨è€ƒè™‘

### åŸŸåå®‰å…¨
- **å”¯ä¸€æ€§ä¿è¯**: æ•°æ®åº“UNIQUEçº¦æŸé˜²æ­¢é‡å¤
- **æ ¼å¼éªŒè¯**: å¤šå±‚éªŒè¯ç¡®ä¿åŸŸåå®‰å…¨
- **é˜²æ¶æ„æ³¨å†Œ**: é™åˆ¶åŸŸåé•¿åº¦å’Œå­—ç¬¦é›†

### éšç§ä¿æŠ¤
- **å¯é€‰è®¾ç½®**: ç”¨æˆ·å¯é€‰æ‹©ä¸è®¾ç½®åŸŸå
- **åˆ é™¤åŠŸèƒ½**: æ”¯æŒéšæ—¶åˆ é™¤åŸŸå
- **è®¿é—®æŽ§åˆ¶**: åŸŸåæŸ¥æ‰¾ä¸æš´éœ²æ•æ„Ÿä¿¡æ¯

## ðŸ“Š ç»Ÿè®¡ä¿¡æ¯

ç³»ç»Ÿæä¾›åŸŸåç›¸å…³ç»Ÿè®¡ï¼š
```json
{
  "totalWallets": 1000,
  "walletsWithDomain": 750,     // è®¾ç½®äº†åŸŸåçš„é’±åŒ…æ•°é‡
  "recentRegistrations": 50
}
```

## ðŸš€ æ‰©å±•å¯èƒ½æ€§

### æœªæ¥åŠŸèƒ½
1. **å­åŸŸåæ”¯æŒ**: `user.company.inj`
2. **åŸŸåè½¬ç§»**: å…è®¸åŸŸååœ¨ç”¨æˆ·é—´è½¬ç§»
3. **åŸŸåå¸‚åœº**: äºŒçº§å¸‚åœºäº¤æ˜“ç¨€ç¼ºåŸŸå
4. **DNSé›†æˆ**: ä¸ŽçœŸå®žDNSç³»ç»Ÿé›†æˆ

### ç”Ÿæ€é›†æˆ
- **é’±åŒ…åº”ç”¨**: åœ¨é’±åŒ…ä¸­æ˜¾ç¤ºåŸŸå
- **DAppé›†æˆ**: åº”ç”¨ä¸­ä½¿ç”¨åŸŸåæ ‡è¯†
- **è·¨é“¾æ”¯æŒ**: åœ¨å…¶ä»–é“¾ä¸Šä½¿ç”¨ç›¸åŒåŸŸå

## ðŸ§ª æµ‹è¯•éªŒè¯

è¿è¡Œå®Œæ•´çš„åŸŸååŠŸèƒ½æµ‹è¯•ï¼š
```bash
node test-injective-domain.js
```

æµ‹è¯•è¦†ç›–ï¼š
- âœ… åŸŸåè®¾ç½®å’ŒéªŒè¯
- âœ… å”¯ä¸€æ€§å†²çªæ£€æµ‹
- âœ… æ ¼å¼éªŒè¯æµ‹è¯•
- âœ… åŸŸåæŸ¥æ‰¾åŠŸèƒ½
- âœ… åˆ é™¤æ“ä½œéªŒè¯

---

## æ€»ç»“

.injåŸŸåç³»ç»Ÿä¸ºNFCé’±åŒ…ç”¨æˆ·æä¾›äº†ä¸ªæ€§åŒ–çš„èº«ä»½æ ‡è¯†æ–¹æ¡ˆï¼Œæ—¢æ»¡è¶³äº†åŠŸèƒ½éœ€æ±‚ï¼Œåˆä¿è¯äº†ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œæ‰©å±•æ€§ã€‚é€šè¿‡å®Œå–„çš„éªŒè¯æœºåˆ¶å’Œç”¨æˆ·å‹å¥½çš„APIè®¾è®¡ï¼Œä¸ºåŽç»­çš„ç”Ÿæ€å»ºè®¾å¥ å®šäº†è‰¯å¥½åŸºç¡€ã€‚ 